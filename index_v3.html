<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>üéÅ Free Lootliste ‚Äì Community Items | D2R Non-Ladder (V3 Test)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --gold:#f5c451;
  --bg:#0b0b0b;
  --panel:#121212;
  --border:#2a2a2a;
  --soft:#1a1a1a;
  --green:#4cff4c;
  --yellow:#ffd24c;
  --red:#ff5c5c;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:radial-gradient(ellipse at top,#181818 0%,#090909 65%);
  color:#eaeaea;
}
.wrapper{max-width:1500px;margin:0 auto}

/* ===== HERO ===== */
.hero{
  background:url("img/banner_diablo.png") center top / cover no-repeat;
  border-radius:0 0 26px 26px;
  overflow:hidden;
  min-height:260px;
  position:relative;
}
.hero-inner{
  padding:44px 36px;
  background:linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.85));
}
.hero-logo img{
  max-width:420px;
  width:100%;
  filter:brightness(.82) contrast(1.05);
}
.hero p{opacity:.9}

/* ===== AUTH BOX ===== */
.auth-box{
  position:absolute;
  top:22px;
  right:24px;
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px 14px;
  border:1px solid var(--border);
  border-radius:14px;
  background:rgba(0,0,0,.55);
  font-size:13px;
}
.auth-box button{
  padding:6px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#151515;
  color:#fff;
  cursor:pointer;
}
.auth-box button:hover{border-color:var(--gold);color:var(--gold)}

.container{padding:30px}
.cards{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:22px;
}
@media(max-width:900px){.cards{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.cards{grid-template-columns:1fr}}

.card{
  background:linear-gradient(180deg,#191919,#0f0f0f);
  border:1px solid var(--border);
  border-radius:20px;
  padding:16px;
  position:relative;
}
.card .cta{
  margin-top:10px;
  padding:8px;
  text-align:center;
  border:1px solid var(--border);
  border-radius:12px;
  cursor:pointer;
}
.card .cta:hover{border-color:var(--gold);color:var(--gold)}
.status{
  position:absolute;
  top:12px;
  right:12px;
  font-size:12px;
  padding:4px 10px;
  border-radius:999px;
}
.verfuegbar{background:rgba(76,255,76,.15);color:var(--green)}
.reserviert{background:rgba(255,210,76,.15);color:var(--yellow)}

footer{
  margin-top:50px;
  padding:22px;
  border-top:1px solid #222;
  font-size:13px;
}
footer a{color:var(--gold);margin-right:18px;text-decoration:none}
</style>
</head>

<body>
<div class="wrapper">

<header class="hero">
  <div class="hero-inner">
    <div class="auth-box">
      <span id="authState">üë§ nicht eingeloggt</span>
      <button id="loginA">Login Tester_A</button>
      <button id="loginB">Login Tester_B</button>
      <button id="logoutBtn">Logout</button>
    </div>

    <h1 class="hero-logo">
      <img src="img/logo_d2r.png" alt="Lootliste Logo">
    </h1>
    <p>Community Lootliste ¬∑ D2R ¬∑ V3 Testbetrieb (Inline)</p>
  </div>
</header>

<div class="container">
  <div class="cards" id="cards"></div>
</div>

<footer>
  <a href="#">Impressum</a>
  <a href="#">Datenschutz</a>
</footer>

</div>

<script>
/* =========================================================
   TEST-ACCOUNTS (INLINE AUTH)
========================================================= */
const USERS = {
  A: { id:"u1", name:"Tester_A" },
  B: { id:"u2", name:"Tester_B" }
};

function setUser(u){
  localStorage.setItem("v3_user", JSON.stringify(u));
  renderAuth();
}
function getUser(){
  try{ return JSON.parse(localStorage.getItem("v3_user")); }
  catch{ return null; }
}
function logout(){
  localStorage.removeItem("v3_user");
  renderAuth();
}

document.getElementById("loginA").onclick=()=>setUser(USERS.A);
document.getElementById("loginB").onclick=()=>setUser(USERS.B);
document.getElementById("logoutBtn").onclick=logout;

function renderAuth(){
  const u=getUser();
  document.getElementById("authState").textContent =
    u ? "üë§ "+u.name : "üë§ nicht eingeloggt";
}
renderAuth();

/* =========================================================
   ITEMS + DEMAND (INLINE BACKEND)
========================================================= */
const STORAGE_KEY="v3_items";

function loadItems(){
  const d=localStorage.getItem(STORAGE_KEY);
  if(d) return JSON.parse(d);
  const seed=[
    {id:"i1",name:"Shako",owner:"u1",status:"Verf√ºgbar",demand:[]},
    {id:"i2",name:"Der Himmelsriss",owner:"u2",status:"Verf√ºgbar",demand:[]}
  ];
  localStorage.setItem(STORAGE_KEY,JSON.stringify(seed));
  return seed;
}
function saveItems(items){
  localStorage.setItem(STORAGE_KEY,JSON.stringify(items));
}

function requestItem(itemId){
  const u=getUser();
  if(!u){ alert("Bitte einloggen"); return; }

  const items=loadItems();
  const item=items.find(i=>i.id===itemId);
  if(item.owner===u.id){
    alert("Du kannst dein eigenes Item nicht anfragen.");
    return;
  }
  if(item.demand.find(d=>d.by===u.id)){
    alert("Du hast bereits Bedarf angemeldet.");
    return;
  }
  item.demand.push({by:u.id,name:u.name,time:Date.now()});
  saveItems(items);
  renderItems();
}

function renderItems(){
  const items=loadItems();
  const u=getUser();
  const cards=document.getElementById("cards");
  cards.innerHTML="";

  items.forEach(i=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <span class="status ${i.status==="Verf√ºgbar"?"verfuegbar":"reserviert"}">${i.status}</span>
      <strong>${i.name}</strong><br>
      <small>Owner: ${i.owner}</small><br>
      <small>üì¨ Anfragen: ${i.demand.length}</small>
      <div class="cta">Item anfragen</div>
    `;
    div.querySelector(".cta").onclick=()=>requestItem(i.id);
    cards.appendChild(div);
  });
}
renderItems();
</script>

</body>
</html>
