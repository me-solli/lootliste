<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>üéÅ Free Lootliste ‚Äì Community Items | D2R Non-Ladder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== THEME ===== */
:root{
  --gold:#f5c451;
  --bg:#0b0b0b;
  --panel:#121212;
  --border:#2a2a2a;
  --green:#4cff4c;
  --yellow:#ffd24c;
  --red:#ff5c5c;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:radial-gradient(ellipse at top,#181818 0%,#090909 65%);
  color:#eaeaea;
}
.wrapper{max-width:1500px;margin:0 auto}

/* ===== HERO ===== */
.hero{
  background:url("img/banner_diablo.png") center / cover no-repeat;
  border-radius:0 0 26px 26px;
  overflow:hidden;
}
.hero-inner{
  padding:40px 36px;
  background:linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.85));
}
.hero h1{margin:0;font-size:40px}
.hero p{opacity:.9}

/* ===== AUTH BOX ===== */
.auth-box{
  position:absolute;
  top:22px;
  right:24px;
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px 14px;
  border:1px solid var(--border);
  border-radius:14px;
  background:rgba(0,0,0,.55);
  font-size:13px;
}
.auth-box button{
  padding:6px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#151515;
  color:#fff;
  cursor:pointer;
}
.auth-box button:hover{
  border-color:var(--gold);
  color:var(--gold);
}

/* ===== CONTENT ===== */
.container{padding:30px}
.cards{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:22px;
}
@media(max-width:1100px){.cards{grid-template-columns:repeat(2,1fr)}}
@media(max-width:650px){.cards{grid-template-columns:1fr}}

.card{
  background:linear-gradient(180deg,#191919,#0f0f0f);
  border:1px solid var(--border);
  border-radius:20px;
  padding:16px;
}
.item-name{font-weight:bold;font-size:16px}
.stars{color:var(--gold)}
.status{font-size:12px;margin-top:4px}

/* ===== MODAL ===== */
.modal-backdrop{
  position:fixed;inset:0;
  background:rgba(0,0,0,.75);
  display:none;
}
.modal{
  position:fixed;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  background:#121212;
  border:1px solid var(--border);
  border-radius:18px;
  padding:22px;
  width:90%;
  max-width:360px;
  display:none;
}
.modal input{
  width:100%;
  margin-bottom:10px;
  padding:10px;
  background:#111;
  border:1px solid #333;
  border-radius:10px;
  color:#fff;
}
.modal button{
  width:100%;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#151515;
  color:#fff;
  cursor:pointer;
}
.modal button:hover{
  border-color:var(--gold);
  color:var(--gold);
}
</style>
</head>

<body>
<div class="wrapper">

<header class="hero">
  <div class="hero-inner">
    <div class="auth-box">
      <span id="authState">üë§ Nicht eingeloggt</span>
      <button onclick="openAuth('login')">Login</button>
      <button onclick="openAuth('register')">Registrieren</button>
    </div>

    <h1><span style="color:var(--gold)">üéÅ</span> Free Lootliste</h1>
    <p>Community Items ¬∑ Diablo II Resurrected ¬∑ Non-Ladder</p>
  </div>
</header>

<div class="container">
  <div class="cards" id="cards">
    <div>‚è≥ Lade Items‚Ä¶</div>
  </div>
</div>

</div>

<!-- AUTH MODAL -->
<div class="modal-backdrop" id="authBg"></div>
<div class="modal" id="authModal">
  <h3 id="authTitle"></h3>
  <input id="authName" placeholder="Username">
  <input id="authPass" type="password" placeholder="Passwort">
  <button onclick="submitAuth()">Absenden</button>
</div>

<script>
/* ===== CONFIG ===== */
const API_BASE = "https://content-connection-production-ea07.up.railway.app";

/* ===== AUTH ===== */
const authState = document.getElementById("authState");
const authModal = document.getElementById("authModal");
const authBg = document.getElementById("authBg");
let authMode = "login";

function openAuth(mode){
  authMode = mode;
  document.getElementById("authTitle").textContent =
    mode === "login" ? "Login" : "Registrieren";
  authModal.style.display = authBg.style.display = "block";
}

authBg.onclick = () => {
  authModal.style.display = authBg.style.display = "none";
};

async function submitAuth(){
  const username = authName.value.trim();
  const password = authPass.value.trim();
  if(!username || !password){
    alert("Bitte ausf√ºllen");
    return;
  }

  const res = await fetch(API_BASE + "/" + authMode, {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ username, password })
  });

  const data = await res.json();
  if(!res.ok){
    alert(data.error || "Fehler");
    return;
  }

  if(authMode === "login"){
    localStorage.setItem("loginId", data.loginId);
    authState.textContent = "üë§ Eingeloggt";
    authModal.style.display = authBg.style.display = "none";
    loadItems();
  } else {
    alert("Registriert ‚úî Jetzt einloggen");
  }
}

/* ===== ITEMS ===== */
async function loadItems(){
  const cards = document.getElementById("cards");
  cards.innerHTML = "‚è≥ Lade Items‚Ä¶";

  const loginId = localStorage.getItem("loginId");
  if(!loginId){
    cards.innerHTML = "üîí Bitte einloggen";
    return;
  }

  const res = await fetch(API_BASE + "/api/items", {
    headers:{ "x-login-id": loginId }
  });

  const items = await res.json();
  if(!Array.isArray(items)){
    cards.innerHTML = "‚ö†Ô∏è Keine Items";
    return;
  }

  cards.innerHTML = "";
  items.forEach(i=>{
    cards.innerHTML += `
      <div class="card">
        <div class="item-name">${i.name}</div>
        <div class="stars">${i.stars || ""}</div>
        <div class="status">${i.status}</div>
      </div>`;
  });
}

/* ===== INIT ===== */
if(localStorage.getItem("loginId")){
  authState.textContent = "üë§ Eingeloggt";
  loadItems();
}
</script>

</body>
</html>
