<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>D2R Lootliste OBS</title>

<style>
:root {
  --set: #00ff66;
  --unique: #d6b25e;
  --magic: #6fa8ff;
  --normal: #e6e6e6;

  --available: #6cff8a;
  --reserved: #ffd479;
  --given: #ff6a6a;
}

body {
  margin: 0;
  background: transparent;
  font-family: Arial, sans-serif;
  color: var(--normal);
}

.wrapper {
  background: rgba(0,0,0,0.7);
  padding: 14px 14px 10px;
  width: 340px;
}

/* ITEM CARD */
.item {
  padding: 9px 8px;
  margin-bottom: 7px;
  border-radius: 10px;
  background: linear-gradient(
    90deg,
    rgba(255,255,255,0.06),
    rgba(0,0,0,0)
  );
  animation: slideIn 0.35s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-6px); }
  to { opacity: 1; transform: translateX(0); }
}

.top {
  display: flex;
  align-items: center;
  gap: 8px;
}

.dot {
  width: 9px;
  height: 9px;
  border-radius: 50%;
  flex-shrink: 0;
}

.dot.verfügbar { background: var(--available); }
.dot.reserviert { background: var(--reserved); }
.dot.vergeben { background: var(--given); }

.name {
  font-size: 15px;
  font-weight: bold;
  line-height: 1.15;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.name.set { color: var(--set); }
.name.unique { color: var(--unique); }
.name.magic { color: var(--magic); }
.name.normal { color: var(--normal); }

.type {
  font-size: 12px;
  opacity: 0.6;
  margin-left: 17px;
  margin-top: 2px;
}

/* MINI FOOTER TEXT */
.footer {
  text-align: center;
  font-size: 11px;
  opacity: 0.45;
  margin-top: 6px;
  letter-spacing: 0.3px;
}
</style>
</head>

<body>
<div class="wrapper">
  <div id="list">Loading…</div>
  <div class="footer">letzte 15 Drops – live</div>
</div>

<script>
const API = "https://lootliste-production.up.railway.app/api/items/latest?limit=15";

function qualityClass(item) {
  if (!item.quality) return "normal";
  const q = item.quality.toLowerCase();
  if (q.includes("set")) return "set";
  if (q.includes("unique")) return "unique";
  if (q.includes("magic")) return "magic";
  return "normal";
}

async function loadItems() {
  const res = await fetch(API);
  const items = await res.json();
  const list = document.getElementById("list");
  list.innerHTML = "";

  items.forEach(i => {
    const el = document.createElement("div");
    const qClass = qualityClass(i);

    el.className = "item";
    el.innerHTML = `
      <div class="top">
        <div class="dot ${i.status}"></div>
        <div class="name ${qClass}" title="${i.name}">
          ${i.name}
        </div>
      </div>
      <div class="type">${i.type}</div>
    `;
    list.appendChild(el);
  });
}

loadItems();
setInterval(loadItems, 60000);
</script>
</body>
</html>
