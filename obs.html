<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>D2R Lootliste OBS</title>

<style>
:root {
  --gold: #e6d8a3;
  --bg: rgba(0,0,0,0.68);
}

body {
  margin: 0;
  background: transparent;
  font-family: Arial, sans-serif;
  color: var(--gold);
}

.wrapper {
  width: 100%;
  background: var(--bg);
  padding: 10px 8px;
}

.item {
  position: relative;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  margin-bottom: 6px;
  border-radius: 12px;
  background: linear-gradient(
    90deg,
    rgba(255,255,255,0.06),
    rgba(0,0,0,0)
  );
  animation: slideIn 0.4s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-10px); }
  to   { opacity: 1; transform: translateX(0); }
}

/* NEU-Glow */
.item.new {
  box-shadow: 0 0 12px rgba(255,180,80,0.35);
}

/* linke Runenlinie */
.item::before {
  content: "";
  position: absolute;
  left: 0;
  top: 10%;
  bottom: 10%;
  width: 3px;
  border-radius: 2px;
  background: rgba(255,255,255,0.15);
}

.icon {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  background: rgba(255,255,255,0.08);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 15px;
}

.content {
  flex: 1;
}

.name {
  font-size: 14px;
  font-weight: bold;
  line-height: 1.1;
}

.type {
  font-size: 11px;
  opacity: 0.65;
  margin-top: 2px;
}

.status {
  width: 22px;
  text-align: center;
  font-size: 14px;
}

.status.verfÃ¼gbar { color: #6CFF8A; }
.status.reserviert { color: #FFD479; }
.status.vergeben { color: #FF6A6A; }
</style>
</head>

<body>
<div class="wrapper" id="list">Loadingâ€¦</div>

<script>
const API = "https://lootliste-production.up.railway.app/api/items/latest?limit=14";
const NEW_MINUTES = 30;

function iconForType(type) {
  switch (type) {
    case "WAFFE": return "âš”ï¸";
    case "RUESTUNG": return "ğŸ›¡ï¸";
    case "HELM": return "ğŸª–";
    case "SCHILD": return "ğŸ›¡ï¸";
    case "GUERTEL": return "ğŸ§·";
    case "SCHUHE": return "ğŸ‘¢";
    case "CHARM": return "ğŸ”®";
    default: return "ğŸ“¦";
  }
}

function statusIcon(status) {
  if (status === "verfÃ¼gbar") return "â—";
  if (status === "reserviert") return "â—";
  return "âœ–";
}

function isNew(createdAt) {
  const diff = Date.now() - new Date(createdAt).getTime();
  return diff < NEW_MINUTES * 60 * 1000;
}

async function loadItems() {
  const res = await fetch(API);
  const items = await res.json();
  const list = document.getElementById("list");
  list.innerHTML = "";

  items.forEach(i => {
    const el = document.createElement("div");
    el.className = "item" + (isNew(i.createdAt) ? " new" : "");
    el.innerHTML = `
      <div class="icon">${iconForType(i.type)}</div>
      <div class="content">
        <div class="name">${i.name}</div>
        <div class="type">${i.type}</div>
      </div>
      <div class="status ${i.status}">${statusIcon(i.status)}</div>
    `;
    list.appendChild(el);
  });
}

loadItems();
setInterval(loadItems, 60000);
</script>
</body>
</html>
