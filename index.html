<!DOCTYPE html>
<!--
  ================================
  LOOTLISTE ‚Äì BLANCO V2 (CLEAN BASE)
  Basis: alte index.html (OPTIK)
  Ziel: saubere Struktur + FAKE-Bl√∂cke
  Keine aktive Logik
  ================================
-->
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Free Lootliste ‚Äì Community Items | D2R Non-Ladder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================================
   DESIGN TOKENS (aus alter index)
================================ */
:root{
  --gold:#f5c451;
  --bg:#0b0b0b;
  --panel:#121212;
  --border:#2a2a2a;
  --soft:#1a1a1a;
  --green:#4cff4c;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:radial-gradient(ellipse at top,#181818 0%,#090909 65%);
  color:#eaeaea;
}

.wrapper{max-width:1500px;margin:0 auto}

/* ================================
   HERO (OPTIK FINAL)
================================ */
.hero{
  background:url("img/banner_diablo.png") center top / cover no-repeat;
  border-radius:0 0 26px 26px;
  overflow:hidden;
  min-height:260px;
  position:relative;
}

.hero-inner{
  padding:44px 36px;
  background: linear-gradient(to bottom, rgba(0,0,0,.28), rgba(0,0,0,.70));
}

.hero-logo img{
  max-width:420px;
  width:100%;
  filter:brightness(.82) contrast(1.05)
          drop-shadow(0 0 10px rgba(0,0,0,.6));
}

.hero p{margin:10px 0 18px;opacity:.9}

.mode-banner{
  margin:-6px 0 22px;
  font-size:13px;
  letter-spacing:.3px;
  color:#dcdcdc;
}
.mode-banner strong{color:var(--green)}
.mode-banner span{opacity:.7;font-size:12px}

.hero-stats{
  display:flex;
  gap:18px;
  flex-wrap:wrap;
  font-size:14px;
}
.hero-stats div{
  padding:8px 14px;
  background:rgba(0,0,0,.4);
  border:1px solid var(--border);
  border-radius:999px;
}

.auth-box{
  position:absolute;
  top:22px;
  right:24px;
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px 14px;
  border:1px solid var(--border);
  border-radius:14px;
  background:rgba(0,0,0,.55);
  font-size:13px;
}

/* ================================
   PROJECT TIMELINE (OPTIK)
================================ */
.project-timeline{
  padding:10px 28px 12px;
  background:linear-gradient(
    180deg,
    rgba(0,0,0,.28),
    rgba(0,0,0,0)
  );
}

/* Label */
.timeline-label{
  padding:4px 0 6px;
  font-size:12px;
  color:#bfa86a;
  opacity:.75;
}

/* Track */
.timeline-track{
  height:1px;
  background:#2a2a2a;
  position:relative;
  margin-bottom:10px;
}

.timeline-progress{
  position:absolute;
  left:0;
  top:0;
  height:1px;
  width:75%;
  background:linear-gradient(90deg,#bfa86a,#6f7f4a);
}

/* Steps */
.timeline-steps{
  display:flex;
  justify-content:space-between;
  margin-bottom:14px;
}

.timeline-step{
  width:14px;
  height:14px;
  border-radius:50%;
  background:#2a2a2a;
}

.timeline-step.done{background:#bfa86a}
.timeline-step.current{background:#6f7f4a}
.timeline-step.future{background:#333;opacity:.5}

/* ================================
   RULES / FLOW BOX (IN TIMELINE)
================================ */
.rules-box{
  margin-top:6px;
  padding:14px 18px;
  border:1px solid rgba(191,168,106,.35);
  border-radius:14px;
  font-size:13px;
  background:rgba(0,0,0,.25);
  box-shadow:
    inset 0 0 12px rgba(191,168,106,.08);
  opacity:.9;
}

.rules-box strong{
  display:block;
  margin-bottom:6px;
  color:#bfa86a;
  font-weight:600;
}

.rules-box p{
  margin:6px 0;
  line-height:1.45;
}

.rules-link{
  display:inline-block;
  margin-top:6px;
  color:var(--gold);
  text-decoration:none;
  font-weight:500;
}

.rules-link:hover{
  text-decoration:underline;
}

/* ================================
   ICON BAR (OPTIK ‚Äì DIABLO)
================================ */
.icon-bar{
  display:flex;
  justify-content:space-between;
  gap:22px;
  padding:28px 32px 32px;
  overflow-x:auto;
  background:
    linear-gradient(
      180deg,
      rgba(0,0,0,.65),
      rgba(0,0,0,.25)
    );
  border-bottom:1px solid rgba(255,255,255,.08);
}

/* Button Basis */
.icon-btn{
  min-width:128px;
  text-align:center;
  padding:18px 14px 16px;
  border-radius:20px;
  border:1px solid rgba(245,196,81,.35);
  background:rgba(0,0,0,.45);
  transition:
    transform .18s ease,
    box-shadow .18s ease,
    border-color .18s ease,
    background .18s ease;
}

/* Icon */
.icon-btn img{
  width:52px;
  height:52px;
  margin-bottom:10px;
}

/* Label */
.icon-btn span{
  display:block;
  font-size:13px;
  letter-spacing:.3px;
}

/* Hover */
.icon-btn:hover{
  transform:translateY(-3px);
  border-color:rgba(245,196,81,.7);
  box-shadow:
    0 0 0 1px rgba(245,196,81,.35),
    0 0 22px rgba(245,196,81,.35);
}

/* Active ‚Äì starker Gold-Glow wie fr√ºher */
.icon-btn.active{
  border-color:var(--gold);
  background:
    radial-gradient(
      circle at top,
      rgba(245,196,81,.22),
      rgba(0,0,0,.6)
    );
  box-shadow:
    0 0 0 1px rgba(245,196,81,.75),
    0 0 36px rgba(245,196,81,.7),
    inset 0 0 20px rgba(245,196,81,.28);
}

.icon-btn.active img{
  filter:
    drop-shadow(0 0 10px rgba(245,196,81,.95))
    drop-shadow(0 0 20px rgba(245,196,81,.65));
}

/* ================================
   CONTENT / META / FILTER
================================ */
.container{padding:30px}
.meta-bar{display:flex;gap:18px;margin-bottom:18px;font-size:13px}
  <div id="resultsInfo" class="results-info">
  <span id="resultsCount">0</span> Items gefunden
</div>
.filter-panel{background:#121212;border:1px solid var(--border);border-radius:18px;padding:18px;margin-bottom:18px}
.filter-panel input,.filter-panel select{padding:10px 12px;background:#111;border:1px solid #333;color:#fff;border-radius:10px}

/* ================================
   CARDS (OPTIK BASIS)
================================ */
.cards{display:grid;grid-template-columns:repeat(3,1fr);gap:22px}
.card{display:flex;background:linear-gradient(180deg,#191919,#0f0f0f);border:1px solid var(--border);border-radius:20px;overflow:hidden}
.card-image{width:120px;background:#0b0b0b;display:flex;align-items:center;justify-content:center}
.card-image img{width:72px;height:72px}
.card-body{padding:16px;display:flex;flex-direction:column;gap:6px}
.item-name{font-size:16px;font-weight:600}
.item-sub{font-size:11px;color:#8a8a8a;letter-spacing:.6px;text-transform:uppercase}
.stars{color:var(--gold)}
.player{font-size:13px;opacity:.85}

/* ================================
   FAKE BLOCKS (VISUAL)
================================ */
.fake-block{
  margin:16px 0;
  padding:14px 16px;
  border:1px dashed rgba(255,255,255,.15);
  border-radius:12px;
  font-size:13px;
  color:#bbb;
  background:rgba(255,255,255,.03);
}
.fake-block strong{color:var(--gold)}

/* ================================
   FOOTER
================================ */
.footer{margin-top:50px;padding:22px;border-top:1px solid #222;font-size:13px;text-align:center}
.footer a{color:var(--gold);text-decoration:none}

  /* ================================
   FILTER UI (BASIC)
================================ */
.filter-row{
  display:flex;
  gap:14px;
  flex-wrap:wrap;
}

.filter-row input{
  flex:1;
  min-width:220px;
}

.filter-row select{
  min-width:160px;
}

.hero-stat{
  padding:8px 14px;
  background:rgba(0,0,0,.4);
  border:1px solid var(--border);
  border-radius:999px;
}

  .auth-box img{
  border-radius:50%;
}

.auth-btn{
  padding:6px 10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#111;
  color:#fff;
  font-size:12px;
  cursor:pointer;
}

  /* ================================
   SCREENSHOT OVERLAY
================================ */
.overlay{
  position:fixed;
  inset:0;
  z-index:9999;
}

.overlay-backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.75);
}

.overlay-content{
  position:relative;
  z-index:1;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100%;
}

.overlay-content img{
  max-width:90%;
  max-height:90%;
  border-radius:12px;
  box-shadow:0 0 40px rgba(0,0,0,.8);
}

  .footer-meta{
  margin-top:10px;
  opacity:.75;
  font-size:12px;
}

  /* ================================
   UX ‚Äì ICON BAR FEEDBACK
================================ */
.icon-btn{
  cursor:pointer;
  transition:transform .15s ease, background .15s ease, border-color .15s ease;
}

.icon-btn:hover{
  transform:translateY(-2px);
  background:rgba(255,255,255,.04);
}

.icon-btn.active{
  border-color:var(--gold);
  background:rgba(245,196,81,.08);
}

  /* ================================
   UX ‚Äì CARDS HOVER & CLICK
================================ */
.card{
  cursor:pointer;
  transition:transform .15s ease, box-shadow .15s ease;
}

.card:hover{
  transform:translateY(-3px);
  box-shadow:0 10px 30px rgba(0,0,0,.4);
}

.card-image{
  cursor:zoom-in;
}

  /* ================================
   UX ‚Äì FILTER FOCUS
================================ */
.filter-panel input:focus,
.filter-panel select:focus{
  outline:none;
  border-color:var(--gold);
  box-shadow:0 0 0 1px rgba(245,196,81,.3);
}

  /* ================================
   UX ‚Äì RESULTS INFO
================================ */
.results-info{
  margin:-6px 0 12px;
  font-size:13px;
  opacity:.75;
}

  /* ================================
   UX ‚Äì SKELETON LOADING
================================ */
.skeletons{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:22px;
}

.skeleton-card{
  height:140px;
  border-radius:20px;
  background:linear-gradient(
    90deg,
    #1a1a1a 25%,
    #222 37%,
    #1a1a1a 63%
  );
  background-size:400% 100%;
  animation:skeleton 1.2s ease-in-out infinite;
}

@keyframes skeleton{
  0%{background-position:100% 0}
  100%{background-position:0 0}
}

  /* ================================
   UX ‚Äì CARD FADE IN
================================ */
.card{
  opacity:0;
  transform:translateY(6px);
  animation:cardFade .35s ease forwards;
}

@keyframes cardFade{
  to{
    opacity:1;
    transform:translateY(0);
  }
}

  /* ================================
   ICON BAR ‚Äì GOLD FRAME + GLOW
================================ */
.icon-btn{
  position:relative;
  border:1px solid rgba(245,196,81,.25);
  border-radius:14px;
  padding:14px 16px;
  transition:
    border-color .2s ease,
    box-shadow .2s ease,
    transform .15s ease,
    background .2s ease;
}

/* Hover ‚Äì dezenter Goldschein */
.icon-btn:hover{
  border-color:rgba(245,196,81,.6);
  box-shadow:
    0 0 0 1px rgba(245,196,81,.25),
    0 0 14px rgba(245,196,81,.25);
}

/* Active ‚Äì klarer Diablo-Gold-Look */
.icon-btn.active{
  border-color:var(--gold);
  background:rgba(245,196,81,.08);
  box-shadow:
    0 0 0 1px rgba(245,196,81,.6),
    0 0 18px rgba(245,196,81,.55),
    inset 0 0 12px rgba(245,196,81,.15);
}

/* Icon leicht hervorheben */
.icon-btn.active img{
  filter:drop-shadow(0 0 6px rgba(245,196,81,.8));
}

/* ================================
   SLOGAN LINE (DIABLO STYLE)
================================ */
.slogan-line{
  margin:28px 0 36px;
  padding:14px 0;
  text-align:center;
  font-size:18px;
  letter-spacing:1.1px;
  opacity:.9;
  color:#e0e0e0;

  background:
    linear-gradient(
      90deg,
      transparent,
      rgba(255,255,255,.06),
      transparent
    );
}

  /* ================================
   FOOTER LINKS
================================ */
.footer-links{
  margin-bottom:8px;
}

.footer-links a{
  color:#aaa;
  text-decoration:none;
  font-size:12px;
}

.footer-links a:hover{
  color:var(--gold);
  text-decoration:underline;
}

.footer-links span{
  margin:0 6px;
  opacity:.5;
}

.footer-note{
  font-size:11px;
  opacity:.55;
}

  /* ================================
   ICON BAR ‚Äì SCROLL FEINSCHLIFF
================================ */
.icon-bar{
  scrollbar-width:thin;
  scrollbar-color:rgba(245,196,81,.4) transparent;
}

.icon-bar::-webkit-scrollbar{
  height:6px;
}

.icon-bar::-webkit-scrollbar-track{
  background:transparent;
}

.icon-bar::-webkit-scrollbar-thumb{
  background:rgba(245,196,81,.35);
  border-radius:6px;
}

/* ================================
   PROJECT STATUS (CLEAN)
================================ */
.project-status{
  margin:24px 28px 10px;
  padding:14px 18px;
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
  background:rgba(255,255,255,.03);
}

.status-line{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:13px;
  color:#cfcfcf;
}

.status-dot{
  width:8px;
  height:8px;
  border-radius:50%;
  background:#6f7f4a; /* ruhiges Gr√ºn */
  box-shadow:0 0 6px rgba(111,127,74,.6);
}

.status-text strong{
  color:#e6e6e6;
  font-weight:600;
}

.status-note{
  margin-top:6px;
  font-size:12px;
  color:#9a9a9a;
  line-height:1.4;
}

  /* ================================
   FILTER + SLOGAN FLOW
================================ */
.filter-slogan-wrap{
  margin: 18px 28px 6px;
  padding: 10px 14px 14px;
  border-radius: 18px;
  background:
    linear-gradient(
      to bottom,
      rgba(255,255,255,.04),
      rgba(255,255,255,0)
    );
}

.loot-slogan{
  text-align:center;
  font-size:14px;
  letter-spacing:.2px;
  color:#cfcfcf;
  opacity:.9;
}

/* Icon-Bar sanfter andocken */
.icon-bar{
  margin-top: 10px;
}

.icon-btn{
  background: rgba(255,255,255,.03);
  border-color: rgba(255,255,255,.08);
}

.icon-btn.active{
  background: rgba(255,215,120,.10);
}
  
</style>
</head>

<body>
<div class="wrapper">

<!-- ================================
     HERO
================================ -->
<header class="hero">
  <div class="hero-inner">

    <div class="auth-box">
      <img src="img/avatars/default.png" alt="Avatar" width="28" height="28">
      <span class="auth-name">Gast</span>
      <button class="auth-btn" type="button">Login</button>
    </div>

    <h1 class="hero-logo">
      <img src="img/logo_d2r.png" alt="D2R Lootliste Logo">
    </h1>

    <p>Community Lootliste ¬∑ Diablo II Resurrected</p>

    <div class="mode-banner">
      Aktueller Modus: <strong>NON-LADDER</strong>
      <span>¬∑ Ladder in Vorbereitung</span>
    </div>

    <div class="hero-stats">
      <div class="hero-stat">
        üì¶ <strong id="heroItemCount">3</strong> Drops
      </div>

      <div class="hero-stat">
        ‚≠ê √ò <strong id="heroAvgRating">4.0</strong>
      </div>

      <div class="hero-stat">
        üßç <strong id="heroDonorCount">3</strong> Spender
      </div>
    </div>

    <!-- VISITOR COUNTER -->
    <div id="visitorCounter" class="visitor-counter">
      üëÅ Besucher gesamt: <strong>26</strong>
    </div>

  </div>
</header>

<!-- ================================
     PROJECT STATUS (MINIMAL)
================================ -->
<section class="project-status">

  <div class="status-line">
    <span class="status-dot"></span>
    <span class="status-text">
      Projektstatus: <strong>Preview / Aufbauphase</strong>
    </span>
  </div>

  <div class="status-note">
    Diese Lootliste befindet sich im Aufbau. Funktionen und Darstellung werden
    schrittweise erweitert.
  </div>

</section>

<!-- ================================
     ICON BAR
================================ -->
<nav class="icon-bar">

  <div class="icon-btn active" data-type="">
    <img src="img/icons/default.png" alt="Alle">
    <span>Alle</span>
  </div>

  <div class="icon-btn" data-type="waffe">
    <img src="img/icons/waffe.png" alt="Waffen">
    <span>Waffen</span>
  </div>

  <div class="icon-btn" data-type="helm">
    <img src="img/icons/helm.png" alt="Helme">
    <span>Helme</span>
  </div>

  <div class="icon-btn" data-type="ruestung">
    <img src="img/icons/ruestung.png" alt="R√ºstungen">
    <span>R√ºstungen</span>
  </div>

  <div class="icon-btn" data-type="schild">
    <img src="img/icons/schild.png" alt="Schilde">
    <span>Schilde</span>
  </div>

  <div class="icon-btn" data-type="amulett">
    <img src="img/icons/amulett.png" alt="Schmuck">
    <span>Schmuck</span>
  </div>

  <div class="icon-btn" data-type="charm">
    <img src="img/icons/charm.png" alt="Charms">
    <span>Charms</span>
  </div>

  <div class="icon-btn" data-type="rune">
    <img src="img/icons/rune.png" alt="Runen">
    <span>Runen</span>
  </div>

  <div class="icon-btn" data-type="sonstiges">
    <img src="img/icons/sonstiges.png" alt="Sonstiges">
    <span>Sonstiges</span>
  </div>

</nav>

<!-- ================================
     SLOGAN
================================ -->
<div class="filter-slogan-wrap">
  <div class="loot-slogan">
    ü©∏ ‚Äî üó°Ô∏è Kein Kampf. Kein Blut. Nur Loot. üó°Ô∏è ‚Äî üíß
  </div>
</div>


<!-- ================================
     CONTENT
================================ -->
<div class="container">

  <div class="meta-bar">
    <!-- FAKE: META_STATS_UPDATE -->
<div class="meta-left">
  üì¶ <strong id="metaItemCount">0</strong> Items
</div>

<div class="meta-right">
  üïí Stand: <span id="metaDate">‚Äì</span>
</div>

  </div>

  <div class="filter-panel">
<div class="filter-row">
  <input
    type="text"
    id="filterSearch"
    placeholder="Item suchen ‚Ä¶"
    autocomplete="off"
  >

  <select id="filterSort">
    <option value="rating-desc">Rating ‚Üì</option>
    <option value="rating-asc">Rating ‚Üë</option>
    <option value="name-asc">Name A‚ÄìZ</option>
    <option value="name-desc">Name Z‚ÄìA</option>
  </select>
</div>

  </div>

<!-- ================================
     CARDS
================================ -->
<section class="cards">

  <!-- SKELETON LOADING -->
  <div id="skeletons" class="skeletons">
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
  </div>

  <!-- EMPTY STATE -->
  <div id="emptyState" class="empty-state" hidden>
    Keine Items gefunden.
  </div>

</section>

</div>
<!-- ================================
     FOOTER
================================ -->
<footer class="footer">

  <div class="footer-links">
    <a href="ueber-das-projekt.html">√úber das Projekt</a>
    <span>¬∑</span>
    <a href="impressum.html">Impressum</a>
    <span>¬∑</span>
    <a href="datenschutz.html">Datenschutz</a>
    <span>¬∑</span>
    <a href="kontakt.html">Kontakt</a>
  </div>

  <div class="footer-meta">
    <span>Version: <strong>Blanco v2</strong></span>
    <span>¬∑</span>
    <span>Status: <strong>Drop-Feed (Preview)</strong></span>
  </div>

</footer>

<!-- ================================
     FAKE: SCREENSHOT_OVERLAY
================================ -->
<div id="screenshotOverlay" class="overlay" hidden>

  <div class="overlay-backdrop"></div>

  <div class="overlay-content">
    <img
      id="overlayImage"
      src=""
      alt="Screenshot Vorschau"
    >
  </div>

</div>

</div>

  <script>
/* ===== ICON BAR (ISOLIERT) ===== */
(function () {
  const bar = document.querySelector(".icon-bar");
  if (!bar) return;

  let activeType = "";

  bar.addEventListener("click", (e) => {
    const btn = e.target.closest(".icon-btn");
    if (!btn) return;

    const type = btn.dataset.type || "";

    bar.querySelectorAll(".icon-btn")
      .forEach(b => b.classList.remove("active"));

    if (activeType === type) {
      activeType = "";
    } else {
      activeType = type;
      btn.classList.add("active");
    }

    // üîï NO-OP: hier passiert bewusst noch nichts
    // sp√§ter: trigger filter/render
    console.log("[ICON BAR] activeType =", activeType);
  });
})();
</script>

<script>
/* ===== META STATS (ISOLIERT) ===== */
(function () {
  const countEl = document.getElementById("metaItemCount");
  const dateEl  = document.getElementById("metaDate");

  if (dateEl) {
    const now = new Date();
    dateEl.textContent = now.toLocaleDateString("de-DE");
  }

  // üîï NO-OP:
  // countEl bleibt bewusst 0
  // sp√§ter: wird vom Cards-Render gesetzt
})();
</script>

  <script>
/* ===== FILTER LOGIC (ISOLIERT / NO-OP) ===== */
(function () {
  const search = document.getElementById("filterSearch");
  const sort   = document.getElementById("filterSort");

  if (!search || !sort) return;

  search.addEventListener("input", () => {
    console.log("[FILTER] search =", search.value);
    // sp√§ter: trigger render
  });

  sort.addEventListener("change", () => {
    console.log("[FILTER] sort =", sort.value);
    // sp√§ter: trigger render
  });
})();
</script>

<script>
/* ===== CARDS FILTER & SORT (FRONTEND ONLY) ===== */
(function () {
  const cards = Array.from(document.querySelectorAll(".card"));
  if (!cards.length) return;

  const bar = document.querySelector(".icon-bar");
  const searchInput = document.getElementById("filterSearch");
  const sortSelect  = document.getElementById("filterSort");

  let activeType = ""; // leer = alle

  // --- Helpers ---
  function getName(card){
    return card.querySelector(".item-name")?.textContent.toLowerCase() || "";
  }

  function getRating(card){
    const txt = card.querySelector(".stars")?.textContent || "";
    const m = txt.match(/(\d)\s*\/\s*5/);
    return m ? Number(m[1]) : 0;
  }

  function apply(){
    const q = (searchInput?.value || "").toLowerCase();

    cards.forEach(card => {
      const typeOk = !activeType || card.dataset.type === activeType;
      const nameOk = !q || getName(card).includes(q);
      card.style.display = (typeOk && nameOk) ? "" : "none";
    });

    // sort only visible cards
    const visible = cards.filter(c => c.style.display !== "none");
    const mode = sortSelect?.value || "rating-desc";

    visible.sort((a,b) => {
      if (mode === "rating-desc") return getRating(b) - getRating(a);
      if (mode === "rating-asc")  return getRating(a) - getRating(b);
      if (mode === "name-asc")    return getName(a).localeCompare(getName(b));
      if (mode === "name-desc")   return getName(b).localeCompare(getName(a));
      return 0;
    });

    const parent = visible[0]?.parentElement;
    if (parent) visible.forEach(c => parent.appendChild(c));
  }

  // --- Icon Bar ---
  bar?.addEventListener("click", (e) => {
    const btn = e.target.closest(".icon-btn");
    if (!btn) return;

    const type = btn.dataset.type || "";
    const isSame = activeType === type;

    bar.querySelectorAll(".icon-btn").forEach(b => b.classList.remove("active"));
    activeType = isSame ? "" : type;
    if (!isSame) btn.classList.add("active");

    apply();
  });

  // --- Search & Sort ---
  searchInput?.addEventListener("input", apply);
  sortSelect?.addEventListener("change", apply);

  // Initial
  apply();
})();
</script>

  <script>
/* ===== META + HERO STATS FROM CARDS (FRONTEND ONLY) ===== */
(function () {
  const cards = () => Array.from(document.querySelectorAll(".card"))
    .filter(c => c.style.display !== "none");

  const metaCount = document.getElementById("metaItemCount");
  const heroCount = document.getElementById("heroItemCount");
  const heroAvg   = document.getElementById("heroAvgRating");
  const heroDonor = document.getElementById("heroDonorCount");

  function getRating(card){
    const txt = card.querySelector(".stars")?.textContent || "";
    const m = txt.match(/(\d)\s*\/\s*5/);
    return m ? Number(m[1]) : 0;
  }

  function getDonor(card){
    const txt = card.querySelector(".player")?.textContent || "";
    const m = txt.match(/Spender:\s*(.+)$/i);
    return m ? m[1].trim() : null;
  }

  function update(){
    const visible = cards();

    // Item counts
    metaCount && (metaCount.textContent = visible.length);
    heroCount && (heroCount.textContent = visible.length);

    // Avg rating
    if (heroAvg) {
      const ratings = visible.map(getRating).filter(n => n > 0);
      const avg = ratings.length
        ? (ratings.reduce((a,b)=>a+b,0) / ratings.length).toFixed(1)
        : "‚Äì";
      heroAvg.textContent = avg;
    }

    // Unique donors
    if (heroDonor) {
      const donors = new Set(visible.map(getDonor).filter(Boolean));
      heroDonor.textContent = donors.size;
    }
  }

  // Recalculate on any filter/sort interaction
  document.addEventListener("click", e => {
    if (e.target.closest(".icon-btn")) update();
  });
  document.getElementById("filterSearch")
    ?.addEventListener("input", update);
  document.getElementById("filterSort")
    ?.addEventListener("change", update);

  // Initial
  update();
})();
</script>

  <script>
/* ===== SCREENSHOT OVERLAY (CLICK TO OPEN) ===== */
(function () {
  const overlay   = document.getElementById("screenshotOverlay");
  const imgTarget = document.getElementById("overlayImage");
  if (!overlay || !imgTarget) return;

  // √ñffnen: Klick auf Card-Image
  document.addEventListener("click", (e) => {
    const img = e.target.closest(".card-image img");
    if (!img) return;

    // Quelle bestimmen:
    // 1) data-full (falls sp√§ter vorhanden)
    // 2) src des Icons (Fallback)
    const fullSrc = img.dataset.full || img.src;
    imgTarget.src = fullSrc;

    overlay.hidden = false;
  });

  // Schlie√üen: Klick auf Backdrop oder ESC
  overlay.addEventListener("click", (e) => {
    if (e.target.classList.contains("overlay-backdrop")) {
      close();
    }
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") close();
  });

  function close(){
    overlay.hidden = true;
    imgTarget.src = "";
  }
})();
</script>

  <script>
/* ===== RESULTS INFO UPDATE ===== */
(function(){
  const info = document.getElementById("resultsInfo");
  const countEl = document.getElementById("resultsCount");
  if (!info || !countEl) return;

  function update(){
    const visible = document.querySelectorAll(
      ".card:not([style*='display: none'])"
    ).length;

    countEl.textContent = visible;
    info.style.display = visible === 0 ? "none" : "";
  }

  // initial
  update();

  // react on filters
  document.addEventListener("input", update);
  document.addEventListener("click", update);
})();
</script>

  <script>
/* ===== SKELETON REMOVE ===== */
(function(){
  const skel = document.getElementById("skeletons");
  if (!skel) return;

  // kurze Verz√∂gerung f√ºr Lade-Gef√ºhl
  setTimeout(() => {
    skel.remove();
  }, 500);
})();
</script>

  <script>
/* ===== CARD FADE RESET ===== */
(function(){
  function reset(){
    document.querySelectorAll(".card").forEach(c => {
      c.style.animation = "none";
      c.offsetHeight; // reflow
      c.style.animation = "";
    });
  }

  document.addEventListener("click", reset);
  document.addEventListener("input", reset);
})();
</script>

<script type="module">
  import { items } from "./items.mock.js";
  import { renderCards } from "./render.cards.js";

  const container = document.querySelector(".cards");
  const skeletons = document.getElementById("skeletons");

  // Meta / Hero
  const metaCount = document.getElementById("metaItemCount");
  const metaDate  = document.getElementById("metaDate");
  const heroCount = document.getElementById("heroItemCount");
  const heroAvg   = document.getElementById("heroAvgRating");
  const heroDonor = document.getElementById("heroDonorCount");

  // Results / Empty
  const resultsInfo  = document.getElementById("resultsInfo");
  const resultsCount = document.getElementById("resultsCount");
  const emptyState   = document.getElementById("emptyState");

  const state = {
    items,
    filtered: items,
    type: "",
    search: "",
    sort: "rating-desc"
  };

  function updateMeta() {
    const list = state.filtered;

    // Counts
    metaCount && (metaCount.textContent = list.length);
    heroCount && (heroCount.textContent = list.length);

    // Avg rating
    if (heroAvg) {
      const ratings = list.map(i => i.rating).filter(Boolean);
      heroAvg.textContent = ratings.length
        ? (ratings.reduce((a,b)=>a+b,0) / ratings.length).toFixed(1)
        : "‚Äì";
    }

    // Unique donors
    if (heroDonor) {
      const donors = new Set(list.map(i => i.donor).filter(Boolean));
      heroDonor.textContent = donors.size;
    }

    // Date
    metaDate && (metaDate.textContent =
      new Date().toLocaleDateString("de-DE")
    );
  }

  function updateResultsUI() {
    const count = state.filtered.length;

    // Results info
    if (resultsInfo && resultsCount) {
      resultsCount.textContent = count;
      resultsInfo.style.display = count === 0 ? "none" : "";
    }

    // Empty state
    if (emptyState) {
      emptyState.hidden = count !== 0;
    }
  }

  function applyFilters() {
    let list = [...state.items];

    // Type
    if (state.type) {
      list = list.filter(i => i.type === state.type);
    }

    // Search
    if (state.search) {
      const q = state.search.toLowerCase();
      list = list.filter(i => i.name.toLowerCase().includes(q));
    }

    // Sort
    if (state.sort === "rating-desc") {
      list.sort((a,b) => b.rating - a.rating);
    }
    if (state.sort === "rating-asc") {
      list.sort((a,b) => a.rating - b.rating);
    }

    state.filtered = list;
    renderCards(state.filtered, container);
    updateMeta();
    updateResultsUI();
  }

  // Initial render
  setTimeout(() => {
    skeletons?.remove();
    applyFilters();
  }, 400);

  // Search
  const searchInput = document.getElementById("filterSearch");
  searchInput?.addEventListener("input", () => {
    state.search = searchInput.value;
    applyFilters();
  });

  // Sort
  const sortSelect = document.getElementById("filterSort");
  sortSelect?.addEventListener("change", () => {
    state.sort = sortSelect.value;
    applyFilters();
  });

  // Icon bar
  const iconBar = document.querySelector(".icon-bar");
  iconBar?.addEventListener("click", e => {
    const btn = e.target.closest(".icon-btn");
    if (!btn) return;

    const type = btn.dataset.type || "";

    iconBar.querySelectorAll(".icon-btn")
      .forEach(b => b.classList.remove("active"));

    state.type = state.type === type ? "" : type;
    if (state.type) btn.classList.add("active");

    applyFilters();
  });

</script>
  
</body>
</html>
