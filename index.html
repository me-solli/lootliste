<!DOCTYPE html>
<!--
  ================================
  LOOTLISTE V3 ‚Äì PUBLIC INDEX
  STATUS: STABLE (PRE-ACCOUNTS)
  NEXT PHASE: USER ACCOUNTS / LOGIN
  ================================
-->
<html lang="de">
<head>
<meta charset="UTF-8">
<title> Free Lootliste ‚Äì Community Items | D2R Non-Ladder (v2.1)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --gold:#f5c451;
  --bg:#0b0b0b;
  --panel:#121212;
  --border:#2a2a2a;
  --soft:#1a1a1a;
  --green:#4cff4c;
  --yellow:#ffd24c;
  --red:#ff5c5c;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:radial-gradient(ellipse at top,#181818 0%,#090909 65%);
  color:#eaeaea;
}

.wrapper{max-width:1500px;margin:0 auto}

/* ===== HERO ===== */
.hero{
  background:url("img/banner_diablo.png") center top / cover no-repeat;
  border-radius:0 0 26px 26px;
  overflow:hidden;
  min-height:260px;
}

.hero-inner{
  padding:44px 36px;
  background: linear-gradient(
    to bottom,
    rgba(0,0,0,.28),
    rgba(0,0,0,.70)
  );
}

.hero h1{margin:0;font-size:42px;letter-spacing:1px}
.hero h1 span{color:var(--gold)}
.hero p{margin:10px 0 18px;opacity:.9}

  /* ===== MODE STATUS (SYSTEM) ===== */
.mode-banner{
  margin:-6px 0 22px;
  font-size:13px;
  letter-spacing:.3px;
  opacity:.95;
  color:#dcdcdc;
}

.mode-banner strong{
  color:var(--green); /* aktiv = gr√ºn */
  font-weight:700;
}

.mode-banner span{
  opacity:.7;
  font-size:12px;
}

.hero-stats{
  display:flex;
  gap:18px;
  flex-wrap:wrap;
  font-size:14px;
}

.hero-stats div{
  padding:8px 14px;
  background:rgba(0,0,0,.4);
  border:1px solid var(--border);
  border-radius:999px;
}

.hero-right{
  margin-top:18px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
}

.twitch{
  background:#9146FF;
  color:#fff;
  padding:12px 18px;
  border-radius:14px;
  font-weight:bold;
  text-decoration:none;
}
.twitch:hover{opacity:.85}

#visitorCounter{font-size:13px;opacity:.85}

/* ===== ICON BAR ===== */
.icon-bar{
  display:flex;
  gap:16px;                          /* vorher 18px */
  padding:25px 24px;                 /* vorher 28px */
  overflow-x:auto;
  background:linear-gradient(180deg,#141414,#0d0d0d);
  border-bottom:1px solid #222;
}

.icon-btn{
  min-width:108px;                   /* vorher 120px */
  text-align:center;
  cursor:pointer;
  padding:16px 8px;                  /* vorher 18px 10px */
  border-radius:18px;
  border:1px solid transparent;
  transition:.25s;
}

.icon-btn img{
  width:52px;                        /* vorher 56px */
  height:52px;
  filter:
    drop-shadow(0 0 9px rgba(245,196,81,.45));
}

.icon-btn span{
  display:block;
  margin-top:9px;                    /* vorher 10px */
  font-size:12.5px;                  /* minimal kleiner */
  font-weight:500;
  letter-spacing:.35px;
  opacity:.95;
}

.icon-btn:hover{
  border-color:var(--gold);
  box-shadow:
    0 0 18px rgba(245,196,81,.26);
}

.icon-btn.active{
  border-color:var(--gold);
  background:rgba(245,196,81,.10);
  box-shadow:
    0 0 24px rgba(245,196,81,.52);
}

/* ===== CONTENT ===== */
.container{padding:30px}

/* ===== META BAR ===== */
.meta-bar{
  display:flex;
  gap:18px;
  flex-wrap:wrap;
  margin-bottom:18px;
  font-size:13px;
  opacity:.9;
}

/* ===== FILTER ===== */
.filter-panel{
  background:linear-gradient(180deg,#171717,#0f0f0f);
  border:1px solid var(--border);
  border-radius:18px;
  padding:18px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  margin-bottom:18px;
}

.filter-panel input,
.filter-panel select{
  padding:10px 12px;
  background:#111;
  border:1px solid #333;
  color:#fff;
  border-radius:10px;
}

/* ===== REQUEST FEED ===== */
.request-feed{
  background:linear-gradient(180deg,#171717,#0f0f0f);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
  margin-bottom:22px;
}

.request-feed h3{
  margin:0 0 10px;
  font-size:15px;
  color:var(--gold);
}

.request-entry{
  font-size:13px;
  padding:6px 0;
  border-bottom:1px solid #222;
  opacity:.9;
}
.request-entry:last-child{border-bottom:none}

/* ===== CARDS ===== */
.cards{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:22px;
}

@media(max-width:1100px){.cards{grid-template-columns:repeat(2,1fr)}}
@media(max-width:650px){.cards{grid-template-columns:1fr}}

.card{
  display:flex;
  background:linear-gradient(180deg,#191919,#0f0f0f);
  border:1px solid var(--border);
  border-radius:20px;
  overflow:hidden;
  transition:.25s;
  position:relative;
}
  
/* ================================
   DIABLO ITEM STATUS ‚Äì METALL RAND
   ================================ */

.card{
  border-left:3px solid #2a2a2a; /* neutral */
}

/* Verf√ºgbar ‚Üí moosig, ents√§ttigt */
.card.verfuegbar{
  border-left-color:#6f7f4a;
}

/* Reserviert ‚Üí dunkles Bernstein */
.card.reserviert{
  border-left-color:#8a6a3a;
}

/* Vergeben ‚Üí dunkles Rotbraun */
.card.vergeben{
  border-left-color:#5a2e2e;
  opacity:.85;
}

/* ===== STATUS BADGE (V3 FINAL) ===== */
.status-badge{
  position:absolute;
  top:12px;
  right:12px;
  font-size:11px;
  padding:4px 10px;
  border-radius:999px;
  font-weight:600;

  background:rgba(0,0,0,.55);
  border:1px solid #2a2a2a;
  color:#ddd;

  text-transform:uppercase;
  letter-spacing:.4px;
}

.status-badge.verfuegbar{
  border-color:#6f7f4a;
  color:#e6edd0;
}

.status-badge.reserviert{
  border-color:#8a6a3a;
  color:#f0e3c2;
}

.status-badge.vergeben{
  border-color:#5a2e2e;
  color:#e8cfcf;
}

.status-badge.reserviert{
  background:linear-gradient(
    180deg,
    rgba(255,210,120,.45),
    rgba(138,106,58,.22)
  );
  color:#fff1d2;
  border:1px solid #caa24a;
}

.status-badge.vergeben{
  background:linear-gradient(
    180deg,
    rgba(255,120,120,.45),
    rgba(90,46,46,.22)
  );
  color:#ffdede;
  border:1px solid #b85a5a;
}

  /* ===== CARD HOVER (V3) ===== */
.card:hover{
  transform:translateY(-4px);
  box-shadow:
    0 12px 28px rgba(0,0,0,.65),
    inset 0 0 0 1px rgba(255,255,255,.04);
}
  
  .card.vergeben:hover{
  transform:none;
  box-shadow:none;
}
  
@keyframes highlightPulse {
  0% {
    box-shadow:
      0 0 0 1px rgba(245,196,81,.35),
      0 0 10px rgba(245,196,81,.2);
  }
  50% {
    box-shadow:
      0 0 0 2px rgba(245,196,81,.85),
      0 0 26px rgba(245,196,81,.65);
  }
  100% {
    box-shadow:
      0 0 0 1px rgba(245,196,81,.35),
      0 0 10px rgba(245,196,81,.2);
  }
}

.card.highlight{
  animation: highlightPulse 1.4s ease-in-out 2;
}

.card-image{
  width:120px;
  background:radial-gradient(circle at top,#1f1f1f,#0b0b0b);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}
  
.card-image img{
  width:72px;
  height:72px;
  object-fit:contain;
  filter:drop-shadow(0 0 10px rgba(245,196,81,.35));
} 
  .card-image{
  cursor:pointer;
}
  .card-image[data-screenshot] {
  cursor: zoom-in;
}

.card-image:hover{
  box-shadow:inset 0 0 0 1px rgba(245,196,81,.35);
}
  
.card-body{
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:6px;
  flex:1;
}

  /* ===== ITEM TIMELINE (CARD / UI ONLY) ===== */

.item-timeline{
  position:relative;
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  margin-top:12px;
  padding:12px 6px 0;
  border-top:1px solid rgba(255,255,255,0.06);
}

.item-timeline .timeline-line{
  position:absolute;
  top:22px;
  left:0;
  right:0;
  height:2px;
  background:url("img/timeline/timeline-line.png") repeat-x center;
  opacity:.6;
  pointer-events:none;
}

.timeline-step,
.item-timeline-step{
  position:relative;
  z-index:1;
  width:56px;
  text-align:center;
  font-size:11px;
  color:#aaa;
}

.timeline-step img,
.item-timeline-step img{
  width:28px;
  height:28px;
  display:block;
  margin:0 auto 6px;
  opacity:.7;
  filter:grayscale(100%);
}

.timeline-step span,
.item-timeline-step span{
  display:block;
  line-height:1.2;
  opacity:.85;
}
  
/* ===== ITEM TIMELINE STATES (PREP / CSS ONLY) ===== */

/* abgeschlossene Schritte */
.timeline-step.is-done img,
.item-timeline-step.is-done img{
  filter:none;
  opacity:0.9;
}

/* aktueller Schritt */
.timeline-step.is-active img,
.item-timeline-step.is-active img{
  filter:none;
  opacity:1;
  box-shadow:0 0 6px rgba(245,196,81,.45);
}

/* finaler Schritt */
.timeline-step.is-final img,
.item-timeline-step.is-final img{
  filter:none;
  opacity:1;
}
  
/* Qualit√§tsfarben */
.item-name.unique{color:#c7a44b;}   /* Unique */
.item-name.set{color:#2ecc71;}      /* Set */
.item-name.rare{color:#f1c40f;}     /* Rare */
.item-name.magic{color:#4aa3ff;}    /* Magic */

  .item-name{
  font-size:16px;
  font-weight:600;
  }
  
.item-sub{
  font-size:11px;
  color:#8a8a8a;
  margin-top:4px;
  letter-spacing:.6px;
  text-transform:uppercase;
  font-weight:500;
}

.category{font-size:12px;opacity:.7}
  
.stars{
  color:var(--gold);
  font-size:16px;       /* +2px reicht v√∂llig */
  font-weight:600;      /* etwas mehr Pr√§senz */
  letter-spacing:1px;   /* hilft beim Z√§hlen */
}

.stars-filled{
  color:var(--gold);
}

.stars-empty{
  color:#555;
}

.stars-num{
  margin-left:6px;
  font-size:11px;
  color:#9a9a9a;
  font-weight:400;
}
  
  .stars-sep{
  margin:0 6px;
  color:#666;
  font-size:13px;
  opacity:.6;
}

.player{font-size:13px;opacity:.85}
.player a{color:var(--gold);text-decoration:none}

.cta{
  margin-top:8px;
  padding:9px;
  text-align:center;
  font-size:13px;
  background:#151515;
  border:1px solid var(--border);
  border-radius:12px;
  color:#fff;
  cursor:pointer;
}
.cta:hover{border-color:var(--gold);color:var(--gold)}

/* ===== REQUEST BUTTON ===== */
.request-btn{
  width:100%;
  margin-top:6px;
  padding:6px 10px;

  background:linear-gradient(#2a2218,#1a140c);
  border:1px solid #3a2f1f;
  border-radius:10px;

  color:#e6d7b3;
  font-size:12px;
  font-weight:500;
  cursor:pointer;
}
  
  .request-btn.disabled{
  opacity:.6;
  cursor:default;
}
  
.request-btn:not(.disabled):hover{
  background:linear-gradient(#2f2618,#1d170e);
  color:#f0e3c2;
  border-color:#6f7f4a;
}
    
  /* ===============================
   V3 CTA ‚Äì visuell beruhigt
   =============================== */

/* CTA standardm√§√üig verborgen */
.card .request-btn{
  opacity:0;
  pointer-events:none;
  transform:translateY(4px);
  transition:opacity .2s ease, transform .2s ease;
}
  /* CTA erscheint nur bei bewusster Interaktion */
.card:hover .request-btn{
  opacity:1;
  pointer-events:auto;
  transform:translateY(0);
}

  /* ===== MODAL ===== */
#requestModal{display:none}

#requestModal .backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  z-index:100;
}

#requestModal .modal{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:#121212;
  border:1px solid var(--border);
  border-radius:18px;
  padding:22px;
  width:90%;
  max-width:420px;
  z-index:101;
  display:flex;
  flex-direction:column;
  gap:10px;
}

#requestModal input,
#requestModal textarea{
  padding:10px;
  background:#111;
  border:1px solid #333;
  border-radius:10px;
  color:#fff;
}

.modal-actions{
  display:flex;
  gap:10px;
}

.modal-actions button{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#151515;
  color:#fff;
  cursor:pointer;
}

.modal-actions button:hover{
  border-color:var(--gold);
  color:var(--gold);
}

footer{
  margin-top:50px;
  padding:22px;
  border-top:1px solid #222;
  font-size:13px;
}
footer a{color:var(--gold);margin-right:18px;text-decoration:none}



/* ===== AUTH BOX ===== */
.hero{ position:relative; }

.auth-box{
  position:absolute;
  top:22px;
  right:24px;
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px 14px;
  border:1px solid var(--border);
  border-radius:14px;
  background:rgba(0,0,0,.55);
  font-size:13px;
  z-index:5;
}
.auth-box button{
  padding:6px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#151515;
  color:#fff;
  cursor:pointer;
}
.auth-box button:hover{
  border-color:var(--gold);
  color:var(--gold);
}


/* ===== AUTH MODAL ===== */
.auth-modal{
  max-width:360px;
}
#authModal .backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  z-index:200;
}
#authModal .modal{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:#121212;
  border:1px solid var(--border);
  border-radius:18px;
  padding:22px;
  width:90%;
  z-index:201;
  display:flex;
  flex-direction:column;
  gap:10px;
}



.hero-logo img{
  max-width:420px;
  width:100%;
  height:auto;
  filter:brightness(0.82) contrast(1.05) drop-shadow(0 0 10px rgba(0,0,0,.6));
}


/* ===== RATING HINT & ICON ===== */
.rating-hint{
  margin:14px 0 10px;
  font-size:13px;
  opacity:.8;
}
.rating-info-icon{
  margin-left:6px;
  cursor:help;
  font-size:13px;
  opacity:.8;
}














/* ===== FOOTER GOLD LINKS FIX ===== */





.footer{
  text-align:center;
  font-size:12px;
  color:#888;
  padding:24px 0;
  border-top:1px solid #222;
}

.footer-links{
  margin-bottom:6px;
}

.footer-links a{
  color:var(--gold, #d4af37);
  text-decoration:none;
}

.footer-links a:hover{
  text-decoration:underline;
}

.footer-links span{
  color:var(--gold, #d4af37);
}

.footer-copy{
  font-size:11px;
  opacity:0.7;
}


/* ===== FOOTER SEPARATOR FIX ===== */
.footer-links{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
}

.footer-links .sep{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:12px;
  transform: translateY(-1px);
}
  
/* ===== PROJECT TIMELINE (V3 ‚Äì FINAL COMPACT) ===== */
.project-timeline{
  padding:6px 28px 4px;
  position:relative;
    z-index:5;
  background:linear-gradient(
    180deg,
    rgba(0,0,0,.25),
    rgba(0,0,0,0)
  );
  opacity:.85;
  overflow:visible; /* wichtig: Tooltip darf nicht abgeschnitten werden */
}

/* Linie */
.timeline-track{
  height:1px;
  background:#2a2a2a;
  margin-bottom:6px;
  position:relative;
}

.timeline-progress{
  position:absolute;
  left:0;
  top:0;
  height:1px;
  width:75%;
  background:linear-gradient(90deg,#bfa86a,#6f7f4a);
}

/* Marker */
.timeline-steps{
  display:flex;
  justify-content:space-between;
  align-items:center;
  overflow:visible; /* Tooltip-Fix */
}

.timeline-step{
  width:14px;
  height:14px;
  border-radius:50%;
  background:#2a2a2a;
  position:relative;
  font-size:0; /* kein Text im Kreis */
  transition:
    box-shadow .22s ease,
    transform .22s ease,
    background-color .22s ease,
    filter .22s ease;
}

/* Zust√§nde */
.timeline-step.done{
  background:#bfa86a;
  box-shadow:0 0 4px rgba(191,168,106,.45);
}

.timeline-step.current{
  background:#6f7f4a;
  box-shadow:0 0 6px rgba(245,196,81,.7);
}

.timeline-step.future{
  background:#333;
  opacity:.5;
}

/* ===== TOOLTIP (mehrzeilig, Stichpunkte) ===== */
.timeline-step::after{
  content:attr(data-tip);
  position:absolute;
  bottom:22px;
  left:50%;
  transform:translateX(-50%);
  background:#111;
  border:1px solid #333;
  padding:8px 10px;
  font-size:11px;
  font-weight:500;
  letter-spacing:.2px;
  white-space:pre-line;   /* erlaubt Zeilenumbr√ºche */
  line-height:1.4;
  opacity:0;
  pointer-events:none;
  transition:opacity .2s ease;
  border-radius:8px;
  box-shadow:0 4px 14px rgba(0,0,0,.65);
  min-width:180px;
}

  @media (max-width:480px){
  .timeline-step::after{
    min-width:140px;
  }
}

.timeline-step:hover::after{
  opacity:1;
}

/* ===== TIMELINE LABEL ===== */
.timeline-label{
  padding:4px 28px 0;
  font-size:12px;
  color:#bfa86a;
  opacity:.75;
  letter-spacing:.3px;
}

/* ===== TIMELINE HOVER GLOW (FINAL) ===== */
.timeline-step:hover{
  transform:scale(1.08);
  filter:saturate(1.25);
}

/* Hover ‚Äì DONE (Gold) */
.timeline-step.done:hover{
  box-shadow:
    0 0 8px rgba(255,215,140,.95),
    0 0 18px rgba(255,195,110,.7),
    0 0 30px rgba(255,175,80,.35);
}

/* Hover ‚Äì CURRENT (st√§rkerer Goldkern) */
.timeline-step.current:hover{
  box-shadow:
    0 0 10px rgba(255,225,160,1),
    0 0 22px rgba(255,200,120,.85),
    0 0 38px rgba(255,170,70,.45);
}

/* Hover ‚Äì FUTURE (zur√ºckhaltend) */
.timeline-step.future:hover{
  box-shadow:
    0 0 6px rgba(255,255,255,.18);
  opacity:.75;
}

  /* ===== TOOLTIP EDGE FIX ===== */

/* Erster Punkt: Tooltip nach rechts schieben */
.timeline-step:first-child::after{
  left:0;
  transform:none;
}

/* Letzter Punkt: Tooltip nach links schieben */
.timeline-step:last-child::after{
  left:auto;
  right:0;
  transform:none;
}

.timeline-step::after::first-line{
  color:var(--gold);
  font-weight:600;
  letter-spacing:.3px;
}
  
  /* ===== FUTURE CONTEXT AREAS ===== */

.account-shell,
.user-context,
.admin-context {
  padding: 10px 14px;
  margin-bottom: 14px;
  border-radius: 8px;
  background: rgba(255,255,255,0.03);
  border: 1px dashed rgba(255,255,255,0.08);
  font-size: 13px;
  color: #bbb;
}

.account-shell strong,
.user-context strong,
.admin-context strong {
  color: #f5c451;
}

  /* ===== RULES BAR (Ablauf & Regeln) ===== */
.rules-bar{
  display:flex;
  justify-content:flex-end;
  padding:8px 28px 14px;
  margin-top:4px;
  background:linear-gradient(
    180deg,
    rgba(0,0,0,.18),
    rgba(0,0,0,0)
  );
}

.rules-bar a{
  color:var(--gold);
  font-size:13px;
  font-weight:500;
  text-decoration:none;
  opacity:.9;
}

.rules-bar a:hover{
  opacity:1;
  text-decoration:underline;
}
  
</style>
</head>

<body>
<div class="wrapper">

<header class="hero">
  <div class="hero-inner">

  <div id="authBox" class="auth-box">
    <span id="authState">üë§ Nicht eingeloggt</span>
    <button id="loginBtn">Login</button>
    <button id="registerBtn">Registrieren</button>
  </div>

    <h1 class="hero-logo"><img src="img/logo_d2r.png" alt="D2R Lootliste Logo"></h1>
    <p>Community Lootliste ¬∑ Diablo II Resurrected</p>

    <div class="mode-banner">
  Aktueller Modus: <strong>NON-LADDER</strong>
  <span>¬∑ Ladder in Vorbereitung</span>
</div>

    <div class="hero-stats" id="heroStats"></div>

    <div class="hero-right">
      
      <div id="visitorCounter">üëÅ Besucher gesamt: ‚Ä¶</div>
      
    </div>
  </div>
</header>

  <!-- ===== ACCOUNT AREA (future) ===== -->
<section class="account-shell" data-role="account-area" hidden>
  <!-- sp√§ter: Login / Profil / Spielerstatus -->
</section>

<!-- ===== PROJECT TIMELINE (INDEX) ===== -->

<div class="timeline-label">
  ‚ìò Projekt-Timeline ¬∑ Entwicklungsstand der Lootliste
</div>

<div class="project-timeline">

  <div class="timeline-track">
    <div class="timeline-progress"></div>
  </div>

  <div class="timeline-steps">

    <div class="timeline-step done"
      data-tip="Grundidee & Planung
‚Ä¢ Community-Lootliste
‚Ä¢ Fokus auf Fairness
‚Ä¢ Non-Ladder Konzept
‚Ä¢ Erste UX-Skizzen">
    </div>

    <div class="timeline-step done"
      data-tip="Version 1
‚Ä¢ Grundfunktionen
‚Ä¢ Item-Liste
‚Ä¢ manuelle Pflege
‚Ä¢ erste Tests">
    </div>

    <div class="timeline-step done"
      data-tip="Version 2
‚Ä¢ Bugfixes
‚Ä¢ saubere Statuslogik
‚Ä¢ UI-Beruhigung
‚Ä¢ Vorbereitung V3">
    </div>

    <div class="timeline-step current"
      data-tip="Version 3
‚Ä¢ strukturierter Ablauf
‚Ä¢ Bedarf anmelden
‚Ä¢ faire Vergabe
‚Ä¢ Community-Fokus">
    </div>

    <div class="timeline-step future"
      data-tip="N√§chste Phase
‚Ä¢ Profile & Accounts
‚Ä¢ Automatisierung
‚Ä¢ weniger Admin-Aufwand">
    </div>

  </div>
</div>
  
<div class="rules-bar">
  <a href="verfahren.html">‚ìò Ablauf & Regeln der Lootliste</a>
</div>

<div class="icon-bar" id="iconBar"></div>
  
<div class="container">

<div class="meta-bar">
  <span id="metaStats"></span>
  </div>

<div class="filter-panel">
  <input id="search" placeholder="Item suchen‚Ä¶">

  <select id="statusFilter">
    <option value="">Alle Status</option>
    <option>Verf√ºgbar</option>
    <option>Reserviert</option>
    <option>Vergeben</option>
  </select>

  <select id="sortRating">
    <option value="desc">Rating ‚Üì</option>
    <option value="asc">Rating ‚Üë</option>
  </select>
</div>

<div class="request-feed">
  <h3>üì¨ Letzte Anfragen</h3>
  <div id="requestFeed"></div>
</div>


<div class="rating-hint">
  ‚ìò Item-Bewertungen dienen der Orientierung und einem einheitlichen roten Faden ‚Äì die Community entscheidet.
</div>


<div class="cards" id="cards"></div>
</div> <!-- container -->

<!-- ===== REQUEST MODAL ===== -->
<div id="requestModal">
  <div class="backdrop"></div>
  <div class="modal">
    <strong id="modalItem"></strong>
    <input id="reqName" placeholder="Dein Nickname *">
    <input id="reqContact" placeholder="Kontakt (Mail oder Discord) *">
    <textarea id="reqMsg" placeholder="Nachricht (optional)"></textarea>
    <div class="modal-actions">
      <button id="sendReq">Anfrage senden</button>
      <button id="closeReq">Abbrechen</button>
    </div>
  </div>
</div>

<script type="module">
  const STATUS_MAP = {
    approved: "Verf√ºgbar",
    reserved: "Reserviert",
    given: "Vergeben"
  };

/* ===== ICON MAPPING ===== */
const ICONS = {
  waffe: "waffe",
  helm: "helm",
  ruestung: "ruestung",
  schild: "schild",
  guertel: "guertel",
  handschuhe: "handschuhe",
  amulett: "amulett",
  ring: "ring",
  charm: "charm",
  rune: "rune",
  sonstiges: "sonstiges"
};
  
  /* ===== TYPE LABELS (Anzeige) ===== */
const TYPE_LABELS = {
  waffe: "Waffe",
  helm: "Helm",
  ruestung: "R√ºstung",
  schild: "Schild",
  guertel: "G√ºrtel",
  handschuhe: "Handschuhe",
  amulett: "Amulett",
  ring: "Ring",
  charm: "Charm",
  rune: "Rune",
  sonstiges: "Sonstiges"
};

  const WEAPON_ICONS = {
  "Schwert": "schwert",
  "Axt": "axt",
  "Keule": "keule",
  "Stab": "stab",
  "Speer": "speer",
  "Dolch": "dolch",
  "Zauberstab": "zauberstab",
  "Bogen": "bogen",
  "Armbrust": "armbrust",
  "Wurfwaffe": "wurfwaffe",
  "Sense": "sense",
  "Klaue": "klaue",
  "Zepter": "zepter"
};

/* ===== DOM ===== */
const iconBar=document.getElementById("iconBar");
const cards=document.getElementById("cards");
const search=document.getElementById("search");
const statusFilter=document.getElementById("statusFilter");
const sortRating=document.getElementById("sortRating");
const heroStats=document.getElementById("heroStats");
const visitorCounter=document.getElementById("visitorCounter");

const modal=document.getElementById("requestModal");

let activeType="";

/* ===== ICON BAR BUILD ===== */
Object.keys(ICONS).forEach(type=>{
  const btn=document.createElement("div");
  btn.className="icon-btn";
  btn.innerHTML=`<img src="img/icons/${ICONS[type]}.png"><span>${TYPE_LABELS[type] || type}</span>`;
  
btn.onclick = () => {
  document.querySelectorAll(".icon-btn")
    .forEach(b => b.classList.remove("active"));

  if (activeType === type) {
    activeType = "";
  } else {
    activeType = type;
    btn.classList.add("active");
  }

  render();
};

  iconBar.appendChild(btn);
});
  

// ===== BACKEND ITEMS =====
let items = [];

async function loadItems() {
  try {
    const res = await fetch(
      "https://content-connection-production-ea07.up.railway.app/api/items/public"
    );
    const data = await res.json();
   console.log("PUBLIC ITEMS DATA:", data);
console.log("TYPE:", Array.isArray(data), typeof data);

items = Array.isArray(data)
  ? data.map(i => {

      // üîç Debug: Rohdaten aus dem Backend

      // ‚≠ê Rating normalisieren
    
const ratingValue = Number(i.rating) || 0;

      // ‚úÖ √ñffentliches Item-Objekt
      return {
        id: i.id,

name: i.name || ("item_" + i.id),

        type: i.type || "sonstiges",
          weaponType: i.weaponType || "",

        // ‚≠ê Sterne f√ºr UI
        rating: ratingValue,

        quality: i.quality || "",
        roll: i.roll || "",

contact: i.contact || "",

status: (() => {
  const s = String(i.status || "").toLowerCase();
  if (s === "approved" || s === "verfuegbar" || s === "available") return "Verf√ºgbar";
  if (s === "reserved" || s === "reserviert") return "Reserviert";
  if (s === "given" || s === "vergeben") return "Vergeben";
  return "Verf√ºgbar";
})(),

screenshot: i.screenshot || ""

      };
    })
  : [];

  } catch (e) {
    console.error("Public Items konnten nicht geladen werden", e);
    items = [];
  }
}
  
function render() {
  cards.innerHTML = "";

const filtered = items
  .filter(i => {
    return !statusFilter.value || i.status === statusFilter.value;
  })
  .filter(i => {

      const q = search.value.toLowerCase();

      const matchesSearch =
        !q ||
        (i.name || "").toLowerCase().includes(q) ||
        (i.type || "").toLowerCase().includes(q);

      const matchesType =
        !activeType || i.type === activeType;

      return matchesSearch && matchesType;
    })
    .sort((a, b) => {
      return sortRating.value === "asc"
        ? (a.rating || 0) - (b.rating || 0)
        : (b.rating || 0) - (a.rating || 0);
    });

  const total = filtered.length;

  const avgRating =
    total === 0
      ? "‚Äì"
      : (
          filtered.reduce((s, i) => s + (i.rating || 0), 0) / total
        ).toFixed(1);

  const uniquePlayers = new Set(
    filtered.map(i => i.contact).filter(Boolean)
  ).size;

  heroStats.innerHTML = `
    <div>üì¶ ${total} Drops</div>
    <div>‚≠ê √ò ${avgRating}</div>
    <div>üßç ${uniquePlayers} Spender</div>
  `;

  document.getElementById("metaStats").textContent =
    `üì¶ ${filtered.length} Treffer ¬∑ üïí ${new Date().toLocaleDateString("de-DE")}`;

  filtered.forEach(item => {
const currentStatus = item.status;
const s =
  currentStatus === "Reserviert" ? "reserviert" :
  currentStatus === "Vergeben"   ? "vergeben"   :
                                   "verfuegbar";

    cards.innerHTML += `
<div class="card ${s}" data-item="${item.name}">
  <span class="status-badge ${s}">${currentStatus}</span>

  <div class="card-image"
    ${item.screenshot ? `data-screenshot="${item.screenshot}"` : ""}>
    <img src="img/icons/${
      item.type === "waffe" && item.weaponType
        ? (WEAPON_ICONS[item.weaponType] || "waffe")
        : (ICONS[item.type] || "default")
    }.png">
  </div>

  <div class="card-body">

    <div class="item-name ${item.quality || ""}">
      ${item.name}
    </div>

    <div class="item-sub">
      ${
        item.type === "waffe"
          ? `Waffe ¬∑ ${item.weaponType}`
          : (TYPE_LABELS[item.type] || "")
      }
    </div>

    ${item.roll ? `<div class="roll">${item.roll}</div>` : ""}

    <div class="stars">
      <span class="stars-filled">${"‚òÖ".repeat(item.rating)}</span>
      <span class="stars-empty">${"‚òÜ".repeat(5 - item.rating)}</span>
      <span class="stars-sep">|</span>
      <span class="stars-num">${item.rating}/5</span>
    </div>

    <div class="player">
      Spieler: ${item.contact || "-"}
    </div>

  </div>
</div>
`;
  });
}
  
/* ===== VISITOR COUNTER ===== */
const K="lootliste_visitors",D="lootliste_last_visit";
const today=new Date().toDateString();
if(localStorage.getItem(D)!==today){
  localStorage.setItem(K,(+localStorage.getItem(K)||0)+1);
  localStorage.setItem(D,today);
}
visitorCounter.innerHTML =
  '&#128065; Besucher gesamt: <b>' + localStorage.getItem(K) + '</b>';
  
/* ===== REQUEST FEED CLICK (HIGHLIGHT ITEM) ===== */
if (requestFeed) {
  requestFeed.addEventListener("click", e => {
    const entry = e.target.closest(".request-entry");
    if (!entry) return;

    const itemName = entry.dataset.item;
    if (!itemName) return;

    const card = document.querySelector(
      `.card[data-item="${CSS.escape(itemName)}"]`
    );
    if (!card) return;

    card.scrollIntoView({
      behavior: "smooth",
      block: "center"
    });

    // üëá alle bestehenden Highlights sofort entfernen
    document.querySelectorAll(".card.highlight")
      .forEach(c => c.classList.remove("highlight"));

    card.classList.add("highlight");

    setTimeout(() => {
      card.classList.remove("highlight");
    }, 2000);
  });
}

/* ===== INIT ===== */
search.oninput = render;
statusFilter.onchange = render;
sortRating.onchange = render;

loadItems().then(() => {
  render();

  // ===== REQUEST FEED VISIBILITY =====
  const feedWrapper = document.querySelector(".request-feed");
  if (feedWrapper && requestFeed) {
    const hasEntries = requestFeed.children.length > 0;
    feedWrapper.style.display = hasEntries ? "block" : "none";
  }
});

</script>

<!-- ===== AUTH (FINAL / LOCAL BACKEND) ===== -->
<!-- DISABLED AUTH BLOCK (DEV MODE) 
<script>
const API = "http://localhost:3000";

const authState = document.getElementById("authState");
const authModal = document.getElementById("authModal");
const authTitle = document.getElementById("authTitle");
const authName = document.getElementById("authName");
const authPass = document.getElementById("authPass");
const loginBtn = document.getElementById("loginBtn");
const registerBtn = document.getElementById("registerBtn");
const authSubmit = document.getElementById("authSubmit");
const authClose = document.getElementById("authClose");

loginBtn.onclick = () => { return; /* AUTH INAKTIV ‚Äì Backend folgt */
  authTitle.textContent = "Login";
  authModal.style.display = "block";
};

registerBtn.onclick = () => { return; /* AUTH INAKTIV ‚Äì Backend folgt */
  authTitle.textContent = "Registrieren";
  authModal.style.display = "block";
};

authClose.onclick = () => authModal.style.display = "none";

authSubmit.onclick = async () => { return; /* AUTH INAKTIV ‚Äì Backend folgt */
  const mode = authTitle.textContent === "Registrieren" ? "register" : "login";
  const username = authName.value.trim();
  const password = authPass.value.trim();

  if (!username || !password) {
    alert("Bitte Benutzername und Passwort eingeben");
    return;
  }

  try {
    const res = await fetch(`${API}/${mode}`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });

    const data = await res.json();
    if (!res.ok) {
      alert(data.error || "Fehler");
      return;
    }

    localStorage.setItem("loot_user", JSON.stringify(data.user));
    authState.textContent = "üë§ " + data.user.username;
    authModal.style.display = "none";
    authName.value = "";
    authPass.value = "";
  } catch {
    alert("Backend nicht erreichbar");
  }
};

// Auto-Login
const saved = localStorage.getItem("loot_user");
if (saved) {
  try {
    const u = JSON.parse(saved);
    authState.textContent = "üë§ " + u.username;
  } catch {}
}
</script>
END DISABLED AUTH BLOCK -->








<footer class="footer">
<div class="footer-links">
  <a href="ueber-das-projekt.html">√úber das Projekt</a>
  <span class="sep">¬∑</span>
  <a href="entwickler.html">√úber den Entwickler</a>
  <span class="sep">¬∑</span>
<a href="cube.html">Cube Guide</a>
  <span class="sep">¬∑</span>
  <a href="impressum.html">Impressum</a>
  <span class="sep">¬∑</span>
  <a href="datenschutz.html">Datenschutz</a>
</div>

  <div class="footer-copy">
    ¬© 2025 D2R Lootliste
  </div>
</footer>

  <!-- ===== SCREENSHOT OVERLAY ===== -->
<div id="screenshotOverlay" style="
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  z-index:9999;
  align-items:center;
  justify-content:center;
">
  <img id="overlayImage" style="
    max-width:90%;
    max-height:90%;
    border-radius:12px;
    box-shadow:0 0 40px rgba(0,0,0,.8);
  ">
</div>

  <!-- ===== SCREENSHOT OVERLAY SCRIPT ===== -->
<script>
const overlay = document.getElementById("screenshotOverlay");
const overlayImg = document.getElementById("overlayImage");

document.addEventListener("click", e => {
  const el = e.target.closest("[data-screenshot]");
  if (!el) return;

  const src = el.dataset.screenshot;
  if (!src) return;

  overlayImg.src =
    "https://content-connection-production-ea07.up.railway.app" + src;

  overlay.style.display = "flex";
});

overlay.addEventListener("click", () => {
  overlay.style.display = "none";
  overlayImg.src = "";
});

document.addEventListener("keydown", e => {
  if (e.key === "Escape") {
    overlay.style.display = "none";
    overlayImg.src = "";
  }
});
</script>
  
<script type="module" src="ui/index-ui.js?v=4"></script>

  </body>  
</html>
