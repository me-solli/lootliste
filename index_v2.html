<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>üéÅ Lootliste ‚Äì Community Items | D2R Non-Ladder (v2 Demo)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --gold:#f5c451;
  --bg:#0b0b0b;
  --panel:#121212;
  --border:#2a2a2a;
  --soft:#1a1a1a;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:
    radial-gradient(ellipse at top,#1a1a1a 0%,#0b0b0b 65%);
  color:#eaeaea;
}

.wrapper{
  max-width:1400px;
  margin:0 auto;
}

/* ===== BANNER ===== */
.banner{
  background:url("img/banner-diablo.jpg") center/cover no-repeat;
  border-radius:0 0 22px 22px;
}

.banner-inner{
  padding:34px 30px;
  background:linear-gradient(rgba(0,0,0,.7),rgba(0,0,0,.9));
  display:flex;
  justify-content:space-between;
  gap:24px;
  flex-wrap:wrap;
}

.banner h1{
  margin:0;
  font-size:34px;
  letter-spacing:.5px;
}

.banner p{
  margin:10px 0 0;
  opacity:.9;
  font-size:15px;
}

.demo-badge{
  display:inline-block;
  margin-top:10px;
  font-size:12px;
  padding:4px 10px;
  border:1px solid var(--gold);
  color:var(--gold);
  border-radius:999px;
}

.banner-right{
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:flex-end;
}

.twitch{
  background:#9146FF;
  color:#fff;
  padding:12px 18px;
  border-radius:14px;
  font-weight:bold;
  text-decoration:none;
}
.twitch:hover{opacity:.85}

#visitorCounter{font-size:13px;opacity:.85}

/* ===== ICON BAR ===== */
.icon-bar{
  display:flex;
  gap:14px;
  padding:18px 22px;
  overflow-x:auto;
  background:linear-gradient(180deg,#121212,#0e0e0e);
  border-bottom:1px solid #222;
}

.icon-btn{
  min-width:90px;
  text-align:center;
  cursor:pointer;
  padding:10px 6px;
  border-radius:14px;
  border:1px solid transparent;
  transition:.2s;
}

.icon-btn img{
  width:40px;
  height:40px;
  object-fit:contain;
  filter:drop-shadow(0 0 6px rgba(245,196,81,.25));
}

.icon-btn span{
  display:block;
  margin-top:6px;
  font-size:12px;
  opacity:.85;
}

.icon-btn:hover{
  border-color:var(--gold);
}

.icon-btn.active{
  border-color:var(--gold);
  background:rgba(245,196,81,.08);
}

/* ===== CONTENT ===== */
.container{
  padding:26px;
}

/* ===== FILTER PANEL ===== */
.filter-panel{
  background:linear-gradient(180deg,#161616,#0f0f0f);
  border:1px solid var(--border);
  border-radius:18px;
  padding:18px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  margin-bottom:14px;
}

.filter-panel input,
.filter-panel select{
  padding:10px 12px;
  background:#111;
  border:1px solid #333;
  color:#fff;
  border-radius:10px;
}

/* ===== INFO BAR ===== */
.info-bar{
  margin-bottom:18px;
  font-size:13px;
  opacity:.9;
}

/* ===== CARDS ===== */
.cards{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:20px;
}

@media(max-width:1100px){.cards{grid-template-columns:repeat(2,1fr)}}
@media(max-width:650px){.cards{grid-template-columns:1fr}}

.card{
  display:flex;
  background:linear-gradient(180deg,#181818,#0f0f0f);
  border:1px solid var(--border);
  border-radius:18px;
  overflow:hidden;
}

.card img{
  width:110px;
  background:radial-gradient(circle at top,#1e1e1e,#0b0b0b);
  object-fit:contain;
  padding:16px;
}

.card-body{
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:6px;
  flex:1;
}

.item-name{font-weight:bold;font-size:15px}
.category{font-size:12px;opacity:.7}
.stars{color:var(--gold)}
.roll{font-size:13px;color:#cfcfcf}

.status{
  font-weight:bold;
  font-size:13px;
}
.status.verfuegbar{color:#4cff4c}
.status.reserviert{color:#ffd24c}
.status.vergeben{color:#ff5c5c}

.player{font-size:13px;opacity:.85}
.player a{color:var(--gold);text-decoration:none}

.cta{
  margin-top:6px;
  padding:8px;
  text-align:center;
  font-size:13px;
  background:#151515;
  border:1px solid var(--border);
  border-radius:10px;
  color:#fff;
  text-decoration:none;
}
.cta:hover{border-color:var(--gold);color:var(--gold)}

footer{
  margin-top:40px;
  padding:20px;
  border-top:1px solid #222;
  font-size:13px;
}
footer a{color:var(--gold);margin-right:16px;text-decoration:none}
</style>
</head>

<body>
<div class="wrapper">

<!-- ===== BANNER ===== -->
<header class="banner">
  <div class="banner-inner">
    <div>
      <h1>Lootliste</h1>
      <p>Community Items ¬∑ Diablo II Resurrected ¬∑ Non-Ladder</p>
      <span class="demo-badge">Design-Demo (v2)</span>
    </div>
    <div class="banner-right">
      <a class="twitch" href="https://www.twitch.tv/me_solli" target="_blank">
        ‚ñ∂ Twitch: me_solli
      </a>
      <div id="visitorCounter">üëÅ Besucher gesamt: ‚Ä¶</div>
    </div>
  </div>
</header>

<!-- ===== ICON BAR ===== -->
<div class="icon-bar" id="iconBar"></div>

<div class="container">

<!-- ===== FILTER ===== -->
<div class="filter-panel">
  <input id="search" placeholder="Item suchen‚Ä¶">

  <select id="statusFilter">
    <option value="">Alle Status</option>
    <option>Verf√ºgbar</option>
    <option>Reserviert</option>
    <option>Vergeben</option>
  </select>

  <select id="sortRating">
    <option value="desc">Rating ‚Üì</option>
    <option value="asc">Rating ‚Üë</option>
  </select>
</div>

<div class="info-bar" id="infoBar"></div>
<div class="cards" id="cards"></div>
</div>

<footer>
  <a href="impressum.html">Impressum</a>
  <a href="datenschutz.html">Datenschutz</a>
</footer>

</div>

<script type="module">
import items from "./items.js";

/* ===== ICON MAP ===== */
const ICONS = {
  "Waffe":"waffe","Helm":"helm","R√ºstung":"ruestung","Schild":"schild",
  "G√ºrtel":"guertel","Handschuhe":"handschuhe","Amulett":"amulett",
  "Ring":"ring","Charm":"charm","Rune":"rune","Sonstiges":"sonstiges"
};

function getIcon(type){
  return `img/icons/${ICONS[type]||"default"}.png`;
}

/* ===== ICON BAR BUILD ===== */
const iconBar=document.getElementById("iconBar");
let activeType="";

Object.keys(ICONS).forEach(type=>{
  const btn=document.createElement("div");
  btn.className="icon-btn";
  btn.innerHTML=`
    <img src="img/icons/${ICONS[type]}.png">
    <span>${type}</span>
  `;
  btn.onclick=()=>{
    document.querySelectorAll(".icon-btn").forEach(b=>b.classList.remove("active"));
    if(activeType===type){activeType="";}
    else{activeType=type;btn.classList.add("active");}
    render();
  };
  iconBar.appendChild(btn);
});

/* ===== CORE ===== */
const cards=document.getElementById("cards");
const search=document.getElementById("search");
const statusFilter=document.getElementById("statusFilter");
const sortRating=document.getElementById("sortRating");
const infoBar=document.getElementById("infoBar");
const visitorCounter=document.getElementById("visitorCounter");

function ratingValue(s){return (s?.match(/‚òÖ/g)||[]).length}

function render(){
  cards.innerHTML="";

  let filtered=items.filter(i=>{
    const q=search.value.toLowerCase();
    return (
      (!activeType||i.type===activeType) &&
      (!statusFilter.value||i.status===statusFilter.value) &&
      (i.name.toLowerCase().includes(q)||i.category.toLowerCase().includes(q))
    );
  });

  filtered.sort((a,b)=>{
    const d=ratingValue(b.stars)-ratingValue(a.stars);
    return sortRating.value==="desc"?d:-d;
  });

  infoBar.innerHTML=`üì¶ ${filtered.length} Items ¬∑ üïí ${new Date().toLocaleDateString("de-DE")}`;

  filtered.forEach(item=>{
    const s=item.status==="Reserviert"?"reserviert":item.status==="Vergeben"?"vergeben":"verfuegbar";
    cards.innerHTML+=`
      <div class="card">
        <img src="${getIcon(item.type)}">
        <div class="card-body">
          <div class="item-name">${item.name}</div>
          <div class="category">${item.category} ¬∑ ${item.type}</div>
          <div class="stars">${item.stars} (${ratingValue(item.stars)}/5)</div>
          <div class="roll">${item.roll||"‚Äî"}</div>
          <div class="status ${s}">${item.status}</div>
          <div class="player">
            Spieler:
            <a href="https://twitch.tv/${item.contact}" target="_blank">${item.contact}</a>
          </div>
          <a class="cta" href="https://twitch.tv/${item.contact}" target="_blank">
            √úber Twitch anfragen
          </a>
        </div>
      </div>`;
  });
}

/* ===== VISITOR COUNTER ===== */
const K="lootliste_visitors",D="lootliste_last_visit";
const t=new Date().toDateString();
if(localStorage.getItem(D)!==t){
  localStorage.setItem(K,(+localStorage.getItem(K)||0)+1);
  localStorage.setItem(D,t);
}
visitorCounter.innerHTML=`üëÅ Besucher gesamt: <b>${localStorage.getItem(K)}</b>`;

search.oninput=render;
statusFilter.onchange=render;
sortRating.onchange=render;
render();
</script>
</body>
</html>
